# Fake bathymetry
# Berry Boessenkool, Nov 2016


bathy <- read.table(header=TRUE, text="
x	y
5.6	16.6
6.1	15.1
7.8	12.5
8.9	9.9
10.5	7.6
11.6	6.7
13.1	6.1
14.5	6.7
14.2	8.6
13.1	8.9
12.7	10.9
11.7	12.1
11	13.5
10.3	15.9
9.8	17.5
9.4	18
8.9	19.9
8.1	22.9
7.5	25.9
7.4	28.8
7.8	29.5
8.9	29.7
9.3	26.8
11	23.4
11.6	22.1
12.4	20.2
13	18.2
13.7	15.9
15.1	12.4
15.7	11.8
16.9	9.9
17.6	8.1
18.9	6.8
20.4	7.4
20.2	10
19.3	13.1
17.9	16.4
16.8	21.1
16.2	24.5
14.2	28.7
13.6	30.3
13.6	32
14	34.1
15.2	34.9
16.8	34.4
18.7	31.4
19.3	29.1
19.6	26.8
20.1	24
20.6	19.5
22	17.5
23.6	15
23.9	13.5
24.3	11.8
25.1	9.6
26.4	8
28.6	7.7
30	9.2
29	11.9
27.6	15.4
26.4	19.4
25.3	21.5
24.5	23.4
23.7	25.9
22.3	32.6
22.1	33.9
21.7	34.5
21.4	38.1
23.3	41.2
24.1	39.6
24.1	37.8
24.8	32.9
26.3	30.3
28.1	27.4
28.6	25.6
30.8	20.4
31.2	17.3
33	15.1
33.8	13.2
35.1	12.4
36.7	12.8
37.9	16
37.2	17.2
35.6	19.9
34.7	22.3
33.9	24.2
32.8	28.7
32	31.7
31.5	33.3
30.8	35.7
30	37.4
29.4	38.3
28.9	40
27.9	42.9
28.1	45.4
28.9	47.6
30.7	45.9
32.2	42.8
33.6	38.7
34.6	35.7
36.2	30.4
37.2	27.9
39	24.3
40.6	22.9
41.8	22.1
43.4	22.4
42.1	24.6
39.9	27.1
38.9	29
38.3	32.2
38.1	34.4
38	36.1
37.6	38.3
36.5	43.8
35.3	45.6
34.6	47.2
33.1	50.2
31.7	52
30.2	54.6
29	57.8
28.4	61
28.8	63
30.9	61.6
32.3	59
33.3	56.5
34.8	55
36.9	50.5
38.8	46.6
40.1	43.8
40.8	42.7
41.8	41.1
43.9	40.5
44.2	41.9
42.6	46
40.3	49.2
38.5	53.6
37.3	56.2
34.4	63.2
31.1	67
29.4	68.3
26.5	70.5
26.2	75
28.8	77.9
32.1	75.4
32.8	72.6
33.8	70.5
35.6	67.1
37.4	62.3
38.2	59.7
42.4	52.7
44.2	50.4
45.9	46.1
47.2	43.8
49.4	41.6
50.7	39.9
52.4	37
53.8	33.8
54.1	32
54.2	30.7
54.2	26.6
55	23
58.6	22.6
58.6	23.4
57.3	26.9
56.3	30.6
55.7	33.2
54.3	38.3
52.7	40.2
51.4	43.2
49.3	48.3
48	51.7
44.9	56.9
43.3	61.6
42.1	64.9
40.1	70.6
37.9	74.4
37.5	76.6
36.3	80.4
35.6	82.8
35.1	85.5
35.8	89.2
37.1	89.5
38.2	88.1
39.5	85.2
40.3	83.4
42	80.5
43.1	76.9
44.3	72.6
45.9	67
49.3	62.5
53.1	58.7
54.5	54.7
56	50.7
56.9	46.1
57.6	42.8
58.7	39.2
60.3	34.4
61.5	31.7
62.6	28.7
63.9	25.5
65.9	24.7
68.2	25.3
67.2	32.6
64.8	39.7
61	53.7
58.3	59.3
52.6	70.3
50.2	77.2
47.8	82.8
46.3	87.9
47.5	91.9
48.9	93.6
52.4	92.9
54.2	88.2
55.2	84.4
55.8	80.9
56.9	75.1
58.1	70.9
59.3	66.7
61.2	64.3
63	59.4
64.5	55.8
67	49.8
67.9	47.9
70	41.9
71.1	39.9
71.8	37.7
73.2	34.6
75.3	32.9
77.6	33.2
77.6	36
76.2	39.3
74.6	42.9
73	46.4
70.9	51.7
68.3	59.5
68.2	59.8
66.3	67.1
65.8	70.2
64.2	76
63.5	78
61.5	83
60.7	85.2
59.2	88.7
58.2	93.5
59	97.1
60.9	97.3
65.7	93.2
66.2	90.7
66.8	86
67.1	83.3
67.4	77.7
68.1	75
68.8	70.9
69.9	66.1
70.9	61.3
73.4	57.4
75	54.4
77.1	48.5
78.2	46.3
79.1	45.1
81.3	44.1
82.5	45.3
83.7	47.7
83	51.2
80.4	56.2
75.8	59.3
73.9	64.6
73.1	66.5
72	74.2
71.3	79.5
70.6	87.8
70.3	89.1
69.4	92.2
")

lake <- data.frame(x = c(11.1, 19.3, 29.9, 35.7, 39.8, 44.3, 47.4, 
47.7, 47.4, 43.9, 41.2, 41.5, 43.3, 44.3, 46.7, 48.4, 49.1, 51.8, 
51.5, 52.1, 55.6, 62.4, 68.2, 75, 78.4, 81.2, 82.5, 84.3, 86, 
86.3, 86, 84.6, 82.9, 81.5, 77.1, 74.7, 74.3, 74.7, 74.7, 72.3, 
70.6, 66.1, 59.3, 50.4, 45.6, 39.5, 32.3, 28.9, 26.5, 24.1, 23.1, 
23.1, 24.5, 25.5, 27.2, 28.2, 27.9, 26.9, 22.4, 20, 18.7, 13.5, 
11.1, 6.7, 6.4, 4.3, 4.3, 5, 6.4, 9.1, 11.1), 
y = c(4.5, 5.2, 
5.2, 8.7, 11.2, 14, 19.3, 23.9, 26.3, 28.4, 29.8, 32.3, 34.8, 
38, 40.4, 40.4, 36.9, 29.8, 27.7, 20.7, 18.9, 19.3, 21, 26.3, 
30.6, 35.1, 37.2, 42.9, 46.1, 51.3, 53.5, 57.3, 61.6, 63.7, 65.1, 
69, 76, 78.5, 83.4, 91.9, 95.4, 99.3, 99.3, 97.5, 96.1, 93.6, 
89.1, 85.9, 81.7, 77.8, 71.4, 69.7, 66.1, 63.3, 56.3, 54.2, 47.8, 
46.1, 42.2, 39.4, 38.7, 36.5, 36.2, 31.3, 29.1, 21, 17.5, 10.1, 
7.3, 3.8, 4.5))


x <- c(lake$x[1:35*2], 16.9, 32.6, 36.7, 44.0, 61.8, 65.8, 57.0)
y <- c(lake$y[1:35*2], 19.4, 25.4, 43.1, 66.4, 77.9, 40.3, 57.3)
z <- c(     rep(0,35),  7.1,  6.3,  4.2,  6.7,  7.8,  6.6, 11.5)

library(geoR)
GEODATEN <- as.geodata(cbind(x,y,z))
EXP_VARIOGRAMM <- variog(GEODATEN, max.dist=40)
FIT_VARIOGRAMM <- variofit(EXP_VARIOGRAMM) 
# plot(EXP_VARIOGRAMM); lines(FIT_VARIOGRAMM)
krico <- krige.control(type.krige="OK", obj.model=FIT_VARIOGRAMM)
krobj <- krige.conv(GEODATEN, loc=bathy, krige=krico)   # KRigingObjekt


plot(lake, type="l")
colPoints(bathy$x,bathy$y,krobj$predict)

write.table(data.frame(x=bathy$x,y=bathy$y,depth=round(krobj$predict,2)), "bathymetry.txt", row.names = F, quote = F)
write.table(lake, "bathymetry_lake.txt", row.names = F, quote = F)

